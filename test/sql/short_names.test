# name: test/sql/short_names.test
# description: Test the short name registration functionality
# group: [duckdb_ast]

require duckdb_ast

# Test 1: Short names don't exist by default
# ==========================================

statement error
SELECT get_type(ast, 'function_definition')
FROM read_ast_objects('test/data/python/simple.py', 'python');
----
Catalog Error: Scalar Function with name get_type does not exist!

# Test 2: Register short names
# ============================

statement ok
PRAGMA duckdb_ast_short_names;

# Test 3: Short names work after registration
# ===========================================

query I
SELECT len((get_type(ast, 'function_definition')).nodes)
FROM read_ast_objects('test/data/python/simple.py', 'python');
----
4

# Test 4: Method syntax also works
# ================================

query I
SELECT len((ast.get_type('function_definition')).nodes)
FROM read_ast_objects('test/data/python/simple.py', 'python');
----
4

# Test 5: Full names still work
# =============================

query I
SELECT len((ast_get_type(ast, 'function_definition')).nodes)
FROM read_ast_objects('test/data/python/simple.py', 'python');
----
4
