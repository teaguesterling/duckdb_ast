# name: test/sql/basic/error_handling.test
# description: Test error handling for invalid inputs
# group: [sitting_duck]

require sitting_duck

# Test 1: Error handling - non-existent file
statement error
SELECT * FROM read_ast('test/data/python/nonexistent.py', 'python');
----
IO Error: Failed to parse files

# Test 2: Cross-language parsing - should have ERROR nodes or no nodes
query I
SELECT CASE 
    WHEN COUNT(*) = 0 THEN true
    WHEN COUNT(*) FILTER (WHERE type = 'ERROR') > 0 THEN true
    ELSE false
END as has_errors_or_empty
FROM read_ast('test/data/python/simple.py', 'javascript');
----
1

# Test 3: Explicit language override - parse Python code with .js extension
query I
SELECT COUNT(*) > 0 as has_nodes 
FROM read_ast('test/data/python/actually_python.js', 'python');
----
1

# Test 4: Invalid language parameter
statement error
SELECT * FROM read_ast('test/data/python/simple.py', 'invalid_language');
----
IO Error: Language 'invalid_language' is not supported